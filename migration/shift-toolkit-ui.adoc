---
sidebar: sidebar 
permalink: migration/shift-toolkit-ui.html 
keywords: netapp, vmware, esxi, vm, migration, openshift, virtualization, hyper-v, proxmox 
summary:  
---
= Configurare NetApp Shift Toolkit
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ../media/


[role="lead"]
Configurare Shift Toolkit per automatizzare la migrazione o la conversione delle VM. Questo processo include l'aggiunta di siti di origine e di destinazione, la configurazione dell'archiviazione, il raggruppamento delle VM in gruppi di risorse, la creazione di progetti di migrazione e la pianificazione delle migrazioni.



== Kit di strumenti Run Shift

* Utilizzando il browser, accedi all'interfaccia utente di Shift Toolkit inserendo `http://<IP address specified during installation>:3001`
+

NOTE: Per un'esperienza ottimale, utilizza Google Chrome o Internet Explorer.

* Accedi all'interfaccia utente utilizzando le credenziali predefinite come di seguito: Nome utente: admin Password: admin
+
image::shift-toolkit-050.png[Diagramma della schermata di accesso NetApp Shift Toolkit]

+

NOTE: Gli amministratori sono tenuti a modificare le proprie credenziali durante l'accesso iniziale.

+

NOTE: Dopo la modifica obbligatoria della password, è possibile modificare anche le credenziali di amministratore utilizzando l'opzione "Cambia password" dopo aver effettuato l'accesso alla GUI.

+
image::shift-toolkit-051.png[Diagramma della schermata di modifica della password NetApp Shift Toolkit]

+
Una volta fatto, accetta l'EULA legale cliccando su "Accetta e continua"

+
image::shift-toolkit-052.png[Screenshot del Contratto di licenza per l'utente finale (EULA) NetApp]





== Configurazione del toolkit di spostamento

Una volta configurati correttamente l'archiviazione e la connettività agli hypervisor di origine e di destinazione, è possibile iniziare a configurare Shift Toolkit per automatizzare la migrazione o la conversione delle macchine virtuali nel formato appropriato, sfruttando la funzionalità FlexClone .



=== Aggiungi siti

Il primo passo è scoprire e aggiungere i dettagli dell'hypervisor di origine e di destinazione (sia hypervisor che storage) al toolkit Shift.  Apri Shift Toolkit in un browser supportato, utilizza il nome utente e la password predefiniti e fai clic su "Aggiungi siti".

image::shift-toolkit-053.png[Finestra di dialogo della finestra di dialogo Aggiungi siti di Shift Toolkit]


NOTE: I siti possono essere aggiunti anche tramite l'opzione Scopri.

Aggiungere le seguenti piattaforme:



==== Fonte

* Dettagli del sito di origine
+
** Nome del sito: fornisci un nome per il sito
** Hypervisor: seleziona VMware o Hyper-V come origine
** Posizione del sito: seleziona l'opzione predefinita
** Connettore: seleziona la selezione predefinita




Una volta compilato, fare clic su Continua.

image::shift-toolkit-054.png[Finestra di dialogo della finestra di dialogo Aggiungi nuovo sito di Shift Toolkit]

* Se la selezione è VMware, immettere i dettagli del vCenter di origine.
+
** Endpoint: immettere l'indirizzo IP o il nome di dominio completo del server vCenter
** Nome utente: nome utente per accedere a vCenter (in formato UPN: nomeutente@dominio.com)
** Password vCenter: password per accedere a vCenter per eseguire l'inventario delle risorse.
** vCenter SSL Thumbprint (facoltativo)


* Se la selezione è Hyper-V, immettere i dettagli di Hyper-V di origine.
+
** Endpoint: immettere l'indirizzo IP o il nome di dominio completo degli host autonomi o dell'endpoint del cluster di failover.
** Nome utente Hyper-V: nome utente per accedere a Hyper-V (in formato di accesso di livello inferiore (dominio\nome utente) o UPN)
** Password Hyper-V: password per accedere a Hyper-V per eseguire l'inventario delle risorse.
+
 Select “Accept Self signed certificate” and click Continue.


* Credenziali del sistema di archiviazione ONTAP


image::shift-toolkit-055.png[Finestra di dialogo della finestra di dialogo Aggiungi nuovo sito di Shift Toolkit]

Una volta aggiunto, Shift Toolkit eseguirà una rilevazione automatica e visualizzerà le VM insieme alle informazioni sui metadati rilevanti. Shift Toolkit rileverà automaticamente le reti e le VLAN utilizzate dalle VM e le popolerà.


NOTE: Se vengono apportate modifiche al sito di origine, assicurarsi di eseguire la scoperta per recuperare le informazioni più recenti. Per farlo, clicca sui 3 punti accanto al nome del sito e poi su "Scopri sito".


NOTE: L'inventario delle VM viene aggiornato automaticamente ogni 24 ore.

image::shift-toolkit-056.png[Finestra di dialogo della finestra di dialogo Aggiungi nuovo sito di Shift Toolkit per scoprire un sito]

Per visualizzare i dati di individuazione per un hypervisor di origine specifico, andare alla dashboard, fare clic su "Visualizza elenco VM" accanto al nome del sito appropriato. La pagina visualizzerà l'inventario delle VM insieme ai relativi attributi.

image::shift-toolkit-057.png[Dialogo dei siti scoperti da Shift Toolkit]

Il passo successivo è aggiungere l'hypervisor di destinazione. Per aggiungerlo, clicca su “Aggiungi nuovo sito” e seleziona “Destinazione”.



==== Destinazione

image::shift-toolkit-058.png[Finestra di dialogo della finestra di dialogo Aggiungi sito di Shift Toolkit per la destinazione]

* Dettagli del sito di destinazione
+
** Nome del sito: fornisci un nome per il sito
** Hypervisor: scegli la piattaforma di destinazione appropriata tra le seguenti opzioni:
+
*** VMware
*** Hyper-V
*** OpenShift
*** OLVM
*** KVM (solo conversione)


** Posizione del sito: seleziona l'opzione predefinita
** Connettore: seleziona la selezione predefinita




Una volta compilato, fare clic su Continua.

image::shift-toolkit-059.png[Finestra di dialogo della finestra di dialogo Aggiungi sito di Shift Toolkit per i dettagli della destinazione]

In base alla selezione dell'hypervisor, compilare i dettagli necessari.

* Dettagli dell'hypervisor di destinazione
+
** Indirizzo IP dell'endpoint o FQDN del rispettivo gestore dell'hypervisor
** Nome utente: nome utente per l'accesso (in formato UPN: nomeutente@dominio.com o dominio\amministratore) Password: password per l'accesso per eseguire l'inventario delle risorse.




Selezionare "Accetta certificato autofirmato".

* Una volta fatto, clicca su "Crea sito"



NOTE: Il sistema di archiviazione di origine e di destinazione deve essere lo stesso, poiché la conversione del formato del disco avviene a livello di volume e all'interno dello stesso volume.

image::shift-toolkit-060.png[Finestra di dialogo della finestra di dialogo Aggiungi sito di Shift Toolkit per i dettagli della destinazione]

Il passaggio successivo consiste nel raggruppare le VM richieste nei rispettivi gruppi di migrazione come gruppi di risorse.



=== Raggruppamenti di risorse

Una volta aggiunte le piattaforme, raggruppa le VM che desideri migrare o convertire in gruppi di risorse.  I gruppi di risorse del toolkit Shift consentono di raggruppare un set di VM dipendenti in gruppi logici che contengono i rispettivi ordini di avvio e ritardi di avvio.


NOTE: Prima di creare i gruppi di risorse, assicurarsi che i Qtree siano predisposti (come indicato nella sezione dei prerequisiti).

Per iniziare a creare gruppi di risorse, fare clic sulla voce di menu "Crea nuovo gruppo di risorse".

. Accedi ai gruppi di risorse, clicca su "Crea nuovo gruppo di risorse".
+
image::shift-toolkit-061.png[Finestra di dialogo dell'interfaccia utente Crea nuovo gruppo di risorse]

. Nel "Nuovo gruppo di risorse", seleziona il sito di origine dal menu a discesa e fai clic su "Crea"
. Fornire i dettagli del gruppo di risorse e selezionare il flusso di lavoro.  Il flusso di lavoro offre due opzioni
+
.. Migrazione basata su cloni: esegue la migrazione end-to-end della VM dall'hypervisor di origine all'hypervisor di destinazione.
.. Conversione basata su clonazione: esegue la conversione del formato del disco nel tipo di hypervisor selezionato.
+
image::shift-toolkit-062.png[Finestra di dialogo dell'interfaccia utente Crea nuovo gruppo di risorse]



. Clicca su “Continua”
. Selezionare le VM appropriate utilizzando l'opzione di ricerca. L'opzione di filtro predefinita è "Datastore".
+

NOTE: Spostare le VM da convertire o migrare in un datastore designato su un SVM ONTAP appena creato prima della conversione. Ciò consente di isolare il datastore NFS di produzione e il datastore designato può essere utilizzato per lo staging delle macchine virtuali.

+

NOTE: Per l'ambiente OpenShift, i VMDK devono essere riposizionati nei volumi corrispondenti per replicare la struttura PVC (Persistent Volume Claim) utilizzando il driver di archiviazione NAS ONTAP . Nelle versioni future saranno incorporati ulteriori miglioramenti per sfruttare il driver economico ONTAP NAS.

+
image::shift-toolkit-063.png[Finestra di dialogo dell'interfaccia utente Crea nuovo gruppo di risorse]

+

NOTE: In questo contesto, il menu a discesa dei datastore mostrerà solo i datastore NFSv3. Gli archivi dati NFSv4 non verranno visualizzati.

+
image::shift-toolkit-064.png[Finestra di dialogo dell'interfaccia utente Crea nuovo gruppo di risorse]

. Aggiorna i dettagli della migrazione selezionando "Sito di destinazione", "Voce hypervisor di destinazione" e "Datastore su Qtree" o mappatura della classe di archiviazione.
+
image::shift-toolkit-065.png[Finestra di dialogo dell'interfaccia utente Crea nuovo gruppo di risorse]

+

NOTE: Assicurarsi che il percorso di destinazione (in cui sono archiviate le VM convertite) sia impostato su un qtree durante la conversione delle VM. Impostare il percorso di destinazione sul qtree appropriato.

+

NOTE: È possibile creare più qtree e utilizzarli per archiviare i dischi VM convertiti.

+

NOTE: Le macchine virtuali possono essere eseguite su datastore distribuiti e Shit Toolkit le rileverà automaticamente; tuttavia, per ogni volume dovrebbe essere mappato un qtree.

+
Possibilità di migrare VM con VMDK distribuiti su più volumi. L'interfaccia utente del toolkit Shift seleziona automaticamente tutti i volumi distribuiti che fanno parte di una VM o delle VM selezionate per quello specifico RG.  Verranno elencati tutti i volumi nella pagina RG in cui eseguiamo il mapping datastore-qtree.

+
image::shift-toolkit-066.png[Finestra di dialogo dell'interfaccia utente Crea nuovo gruppo di risorse]

. Selezionare l'ordine di avvio e il ritardo di avvio (sec) per tutte le VM selezionate. Imposta l'ordine della sequenza di accensione selezionando ogni macchina virtuale e impostandone la priorità. 3 è il valore predefinito per tutte le macchine virtuali. Le opzioni sono le seguenti: 1 – La prima macchina virtuale ad accendersi 3 – Predefinito 5 – L’ultima macchina virtuale ad accendersi
+
image::shift-toolkit-067.png[Finestra di dialogo dell'interfaccia utente Crea nuovo gruppo di risorse]

. Fare clic su "Crea gruppo di risorse".
+
image::shift-toolkit-068.png[Finestra di dialogo dell'interfaccia utente Crea nuovo gruppo di risorse]

+

NOTE: Nel caso in cui sia necessario modificare il gruppo di risorse per aggiungere o rimuovere macchine virtuali, utilizzare questa opzione accanto al nome del gruppo di risorse e selezionare "Modifica gruppo di risorse".





=== Progetti

Per migrare o convertire macchine virtuali è necessario un piano. Selezionare le piattaforme hypervisor di origine e di destinazione dal menu a discesa e scegliere i gruppi di risorse da includere in questo progetto, insieme al raggruppamento delle modalità di accensione delle applicazioni (ad esempio controller di dominio, quindi livello 1, quindi livello 2, ecc.). Spesso vengono anche chiamati piani di migrazione. Per definire il progetto, vai alla scheda "Progetti" e clicca su "Crea nuovo progetto".

Per iniziare a creare un progetto, fare clic su "Crea nuovo progetto".

. Accedi a Blueprints, clicca su "Crea nuovo Blueprint".
+
image::shift-toolkit-069.png[Finestra di dialogo dell'interfaccia utente di Access Blueprints]

. Nel "Nuovo progetto", fornire un nome per il piano e aggiungere i mapping host necessari selezionando Sito di origine > vCenter associato, Sito di destinazione e hypervisor associato.
. Una volta completate le mappature, selezionare la mappatura del cluster e dell'host. Nell'esempio seguente, Hyper-V è mostrato come destinazione.  L'opzione hypervisor visualizzata varierà in base al sito di origine selezionato.
+
image::shift-toolkit-070.png[Finestra di dialogo dell'interfaccia utente Crea nuovi progetti]

. Seleziona Dettagli gruppo risorse e clicca su “Continua”
+
image::shift-toolkit-071.png[Finestra di dialogo dell'interfaccia utente Crea nuovi progetti]

. Imposta l'ordine di esecuzione per il gruppo di risorse.  Questa opzione consente di selezionare la sequenza delle operazioni quando sono presenti più gruppi di risorse.
. Dopo aver completato i passaggi precedenti, seleziona Mappatura di rete e assegnala alla mappa di rete appropriata.  Assicurarsi che gli switch virtuali, i profili di rete o gli operatori siano già predisposti sull'hypervisor di destinazione.
+
image::shift-toolkit-072.png[Finestra di dialogo dell'interfaccia utente Crea nuovi progetti]

+

NOTE: Per la migrazione di prova, la selezione predefinita è "Non configurare la rete" e Shift Toolkit non esegue l'assegnazione dell'indirizzo IP. Una volta convertito il disco e acquistata la macchina virtuale sul rispettivo lato hypervisor, assegnare manualmente gli switch di rete a bolla per evitare qualsiasi collisione con la rete di produzione.

+
image::shift-toolkit-073.png[Finestra di dialogo dell'interfaccia utente Crea nuovi progetti]

. In base alla selezione delle VM, le mappature di archiviazione verranno selezionate automaticamente.
+

NOTE: Assicurarsi che il qtree sia stato predisposto in anticipo e che siano state assegnate le autorizzazioni necessarie affinché la macchina virtuale possa essere creata e accesa.  NOTA: nel caso di OpenShift, i PVC vengono creati utilizzando Trident CSI e non è necessario pre-creare qtree.

. Nei dettagli della VM, fornire l'account di servizio e credenziali utente valide per ciascun tipo di sistema operativo.  Viene utilizzato per connettersi alla macchina virtuale per creare ed eseguire determinati script necessari per rimuovere gli strumenti VMware ed eseguire il backup dei dettagli di configurazione IP.
+
.. Per i sistemi operativi basati su Windows, si consiglia di utilizzare un utente con privilegi di amministratore locale. È possibile utilizzare anche le credenziali di dominio, ma prima della conversione è necessario assicurarsi che sulla macchina virtuale sia presente un profilo utente, altrimenti le credenziali di dominio non funzioneranno, poiché cercheranno l'autenticazione del dominio in assenza di una rete connessa.
.. Nel caso di VM guest basate su distribuzione Linux, fornire un utente in grado di eseguire comandi sudo senza password, ovvero l'utente dovrebbe far parte dell'elenco sudoers o essere aggiunto come nuovo file di configurazione alla cartella /etc/sudoers.d/.
+
image::shift-toolkit-074.png[Finestra di dialogo dell'interfaccia utente Crea nuovi progetti]

+
Nella versione più recente, Shift Toolkit ha introdotto una maggiore flessibilità nella preparazione delle macchine virtuali.  Per impostazione predefinita, il toolkit automatizza la preparazione della VM distribuendo script specifici del sistema operativo per: * Rimuovere VMware Tools * Eseguire il backup delle impostazioni IP per la riassegnazione in base al Blueprint selezionato

+
+ Grazie al nuovo miglioramento, gli utenti possono ora ignorare le attività prepareVM predefinite, consentendo di eseguire script personalizzati per la preparazione manuale della VM, inclusa l'assegnazione di IP.  Ciò garantisce un maggiore controllo per gli ambienti con requisiti di configurazione o conformità specifici.



. Di nuovo, in Dettagli VM, seleziona l'opzione di configurazione IP pertinente. Per impostazione predefinita, è selezionata l'opzione "Non configurare".
+
.. Per migrare le VM con gli stessi IP dal sistema di origine, selezionare "Mantieni IP".
.. Per migrare le VM utilizzando IP statici nel sistema di origine e assegnare DHCP alle VM di destinazione, selezionare "DHCP".
+
Per il corretto funzionamento di questa funzionalità, assicurarsi che siano soddisfatti i seguenti requisiti:

+
*** Assicurarsi che le VM siano accese durante la fase prepareVM e fino all'orario di migrazione pianificato.
*** Per le VM VMware, assicurarsi che VMware Tools sia installato.
*** Per Hyper-V come hypervisor di origine, assicurarsi che i servizi di integrazione siano abilitati e configurati.
*** Per OLVM e OpenShift come hypervisor di destinazione, assicurarsi di montare il file ISO virtIO sulle VM Windows.
*** Assicurarsi che lo script di preparazione venga eseguito sulla macchina virtuale di origine da un account con privilegi di amministratore sul sistema operativo Windows e con privilegi sudo senza opzione password sul sistema operativo di distribuzione basato su Linux per creare cron job.




. Il passaggio successivo è la configurazione della VM.
+
** Facoltativamente, è possibile ridimensionare i parametri CPU/RAM delle VM, il che può essere molto utile per il ridimensionamento.
** Sostituzione dell'ordine di avvio: modifica anche l'ordine di avvio e il ritardo di avvio (sec) per tutte le VM selezionate nei gruppi di risorse.  Questa è un'opzione aggiuntiva per modificare l'ordine di avvio se sono necessarie modifiche rispetto a quanto selezionato durante la selezione dell'ordine di avvio del gruppo di risorse.  Per impostazione predefinita, viene utilizzato l'ordine di avvio selezionato durante la selezione del gruppo di risorse; tuttavia, è possibile apportare modifiche in questa fase.
** Accensione: deselezionare questa opzione se il flusso di lavoro non deve accendere la macchina virtuale.  L'opzione predefinita è ON, il che significa che la VM sarà accesa.
** Rimuovi gli strumenti VMware: Shift Toolkit rimuove gli strumenti VMware dopo la conversione. Questa opzione è selezionata per impostazione predefinita. Questa opzione può essere deselezionata se si prevede di eseguire script personalizzati del cliente.
** Generazione: il toolkit Shift utilizza la seguente regola pratica e imposta per impostazione predefinita quella appropriata: Gen1 > BIOS e Gen2 > EFI.  Per questa opzione non è possibile effettuare alcuna selezione.
** Mantieni MAC: è possibile mantenere l'indirizzo MAC delle rispettive VM per superare le difficoltà di licenza per le applicazioni che si basano su MAC.
** Sostituzione dell'account di servizio: questa opzione consente di specificare un account di servizio separato se non è possibile utilizzare quello globale.
+
image::shift-toolkit-075.png[Finestra di dialogo dell'interfaccia utente del gruppo di risorse]



. Fare clic su "Continua".
. Nel passaggio successivo, pianifica la migrazione selezionando la casella di controllo per impostare la data e l'ora. Assicurarsi che tutte le macchine virtuali (VM) siano preparate e spente prima della data pianificata. Una volta fatto, clicca su "Crea progetto".
+
image::shift-toolkit-076.png[Finestra di dialogo dell'interfaccia utente del gruppo di risorse]

+

NOTE: Durante la pianificazione, scegli una data che sia almeno 30 minuti avanti rispetto all'orario corrente di Shift VM. Ciò serve a garantire che il flusso di lavoro abbia tempo sufficiente per preparare le VM all'interno del gruppo di risorse.

. Una volta creato il progetto, viene avviato un processo prepareVM che esegue automaticamente gli script sulle VM di origine per prepararle alla migrazione
+
image::shift-toolkit-077.png[Finestra di dialogo dell'interfaccia utente del gruppo di risorse]

+
Questo processo esegue uno script utilizzando il metodo invoke-VMScript per copiare gli script necessari per rimuovere gli strumenti VMware ed eseguire il backup dei dettagli della configurazione di rete, tra cui indirizzo IP, percorsi e informazioni DNS, che verranno utilizzati per mantenere le stesse impostazioni sulla VM di destinazione.

+
.. Per i sistemi operativi basati su Windows, la posizione predefinita in cui vengono archiviati gli script di preparazione è la cartella "C:\ NetApp".
+
image::shift-toolkit-078.png[Finestra di dialogo dell'interfaccia utente del gruppo di risorse]

.. Per le VM basate su Linux, la posizione predefinita in cui vengono archiviati gli script di preparazione è / NetApp e la directory /opt.
+
image::shift-toolkit-079.png[Finestra di dialogo dell'interfaccia utente del gruppo di risorse]

+

NOTE: Per una macchina virtuale sorgente Linux che esegue CentOS o Red Hat, il toolkit Shift è intelligente e installa automaticamente i driver Hyper-V necessari. Questi driver devono essere presenti nella VM di origine prima della conversione del disco per garantire che la VM possa avviarsi correttamente dopo la conversione.

+

NOTE: Per informazioni dettagliate, fare riferimento alink:https://access.redhat.com/solutions/3465011["Sistema bloccato in dracut dopo la migrazione di una VM RHEL a Hyper-V"] .

+
Una volta completato correttamente il processo prepareVM (come mostrato nello screenshot qui sotto), le VM sono pronte per la migrazione e lo stato del blueprint verrà aggiornato in "Attivo".

+
image::shift-toolkit-080.png[Finestra di dialogo dell'interfaccia utente del gruppo di risorse]

+
image::shift-toolkit-081.png[Finestra di dialogo dell'interfaccia utente del gruppo di risorse]

+
La migrazione avverrà ora all'ora impostata oppure può essere avviata manualmente cliccando sull'opzione Migra.




