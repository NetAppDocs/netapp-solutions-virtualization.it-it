---
sidebar: sidebar 
permalink: migration/shift-toolkit-migration.html 
keywords: netapp, vmware, esxi, vm, migration, openshift, virtualization, hyper-v, proxmox 
summary: 'Utilizzare Shift Toolkit per migrare le VM tra piattaforme di virtualizzazione.  Il processo prevede la preparazione delle VM, la conversione dei formati dei dischi e la configurazione delle impostazioni di rete nell"ambiente di destinazione.' 
---
= Migrare le VM utilizzando Shift Toolkit
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ../media/


[role="lead"]
Utilizzare Shift Toolkit per migrare le VM tra piattaforme di virtualizzazione.  Il processo prevede la preparazione delle VM, la conversione dei formati dei dischi e la configurazione delle impostazioni di rete nell'ambiente di destinazione.



== Migrazioni supportate

Shift Toolkit offre flessibilità negli ambienti multi-hypervisor supportando la migrazione bidirezionale tra i seguenti hypervisor:

* link:shift-toolkit-migrate-esxi2hyperv.html["Da VMware ESXi a Microsoft Hyper-V"]
* link:shift-toolkit-migrate-hyperv2esxi.html["Da Microsoft Hyper-V a VMware ESXi"]
* link:shift-toolkit-migrate-esxi2olvm.html["Da VMware ESXi a Oracle Linux Virtualization Manager (OLVM)"]
* link:shift-toolkit-migrate-esxi2osv.html["Virtualizzazione da VMware ESXi a Red Hat OpenShift"]




== Flusso di lavoro di migrazione

Dopo aver creato un progetto, è possibile avviare il processo di migrazione.  Durante la migrazione, Shift Toolkit esegue una serie di passaggi per convertire i formati dei dischi e creare macchine virtuali sull'host di destinazione come definito nel progetto.

Shift Toolkit esegue i seguenti passaggi durante la migrazione:

. Elimina gli snapshot esistenti per tutte le VM nel blueprint
. Attivare snapshot VM per il progetto all'origine
. Attiva l'istantanea del volume prima della conversione del disco
. Clona e converti VMDK nel formato VHDx per tutte le VM
. Accendere le VM nel gruppo di protezione nella destinazione
. Registrare le reti su ogni VM
. Rimuovere VMware Tools e assegnare indirizzi IP utilizzando script di attivazione o cron job a seconda del tipo di sistema operativo




== Suggerimenti e considerazioni sulla rete

Quando pianifichi la migrazione, tieni in considerazione i seguenti requisiti e comportamenti di rete.  Shift Toolkit copia automaticamente le impostazioni di rete dalle VM di origine e le riapplica alle VM migrate, ma la denominazione dell'interfaccia e le configurazioni delle schede di rete possono variare tra i sistemi Windows e Linux.

.Requisito generale
* Assicurarsi che gli indirizzi IP statici siano disponibili e non assegnati a un'altra VM


.VM Windows
* Lo script di preparazione copia i dettagli della configurazione di rete (spazio degli indirizzi IP, indirizzo del gateway, server DNS)
* Lo script di attivazione riapplica le impostazioni di rete durante la migrazione per una o più schede di rete in base alla mappatura del progetto
* Dopo la migrazione, Gestione dispositivi di Windows potrebbe visualizzare le informazioni sulla vecchia scheda di rete precedente alla migrazione, che non influiscono sulla nuova scheda né causano conflitti IP.
* Aggiorna alla versione 4.0 per rimuovere automaticamente i dispositivi di rete orfani dal registro e da Gestione dispositivi


.VM Linux
* Lo script di preparazione copia i dettagli della configurazione di rete (spazio degli indirizzi IP, percorsi, server DNS, nomi dei dispositivi di rete)
* Lo script identifica il tipo di rete della distribuzione Linux e applica le impostazioni IP di conseguenza
* Lo script di riassegnazione della rete è configurato come un cron job utilizzando crontab e attivato all'avvio
* Lo script riapplica le impostazioni di rete per una o più schede di rete in base alla mappatura del progetto


.Denominazione dell'interfaccia
* Le VM convertite possono avere nomi di interfaccia come `eth0` O `ensp0` invece dei nomi dell'interfaccia sorgente (ad esempio, `ens192` O `ens33` )
* Lo script aggiorna i dettagli della configurazione di rete per abbinarli ai nuovi nomi di interfaccia
* Se vengono utilizzati nomi prevedibili con regole di corrispondenza udev appropriate e il nome dell'interfaccia viene mantenuto sull'hypervisor di destinazione, lo script salta la configurazione di rete, rimuove VMware Tools e riavvia la VM



NOTE: Shift Toolkit consente di ignorare la preparazione della rete, consentendo agli amministratori di eseguire script personalizzati per l'assegnazione di IP o altre configurazioni.

.Meccanismi di rete supportati
* NetworkManager
* Netplan
* ifconfig
* malvagio


Shift Toolkit conserva gli indirizzi IP come specificato nel progetto.



== Fasi della migrazione

Di seguito sono riportate le fasi di migrazione da seguire per migrare le VM utilizzando Shift Toolkit.

. *Preparare la VM*: preparare le VM per la migrazione e verificare che tutti i prerequisiti siano stati completati.
. *Migrazione e convalida*: una volta completata la preparazione, migrare le VM VMware all'hypervisor di destinazione.
+
Una volta completata la migrazione, verificare che le VM si avviino correttamente e che i dati siano stati migrati correttamente.

. *Test della migrazione*: il test della migrazione simula la migrazione convertendo il VMDK nel formato appropriato e creando VM utilizzando il file del disco virtuale convertito sul qtree.
+
La migrazione di prova non include la configurazione della mappatura di rete, che deve essere eseguita manualmente su una rete di prova.




NOTE: Shift Toolkit non modifica la VM di origine, fatta eccezione per la copia degli script necessari per la preparazione della VM.  Ciò consente un rapido ripristino in caso di errori di conversione.



== Eseguire una migrazione

Per avviare il flusso di lavoro di migrazione con la configurazione specificata nel progetto, fare clic su *Migra*.

image::shift-toolkit-030.png[Finestra di dialogo che mostra come attivare una migrazione della VM]

Una volta avviato, il flusso di lavoro si attiva e il processo di conversione segue i passaggi descritti per registrare la VM.  Se le VM all'interno del blueprint non vengono spente, Shift Toolkit richiede un arresto regolare prima di procedere.

image::shift-toolkit-031.png[Conferma del processo di migrazione]


NOTE: NetApp consiglia di non attivare più di dieci conversioni in parallelo dalla stessa origine alla stessa destinazione.

image::shift-toolkit-032.png[Progressi nella migrazione]

La conversione di VMDK in qualsiasi formato di file avviene in pochi secondi, rendendo questa l'opzione più rapida disponibile.  Questo approccio aiuta a ridurre i tempi di inattività delle VM durante la migrazione.

image::shift-toolkit-033.png[Avanzamento della conversione del disco]

Una volta completato il lavoro, lo stato del progetto cambia in "Migrazione completata".

image::shift-toolkit-034.png[Stato di migrazione completata]
